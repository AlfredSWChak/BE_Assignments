labs(title = 'Trace plot of µ (in case of normal prior distribution for µ where m_prior = 0, v_prior = 10000)',
x = 'Draw', y = 'µ') +
theme_minimal()
ggsave('figures/b_normalPrior_tracePlot.png', width = 10, height = 6, dpi = 300)
# estimate the posterior probabilities
print('The posterior probabilities are:')
sum_mu_greater_0 <- sum(b_result$mu[numberOfBurnIn:numberOfSimulations] > 0)
print(paste('Pr(µ > 0 | y) =', sum_mu_greater_0/(numberOfSimulations-numberOfBurnIn)))
sum_mu_less_0 <- sum(b_result$mu[numberOfBurnIn:numberOfSimulations] < 0)
print(paste('Pr(µ < 0 | y) =', sum_mu_less_0/(numberOfSimulations-numberOfBurnIn)))
print('Gibbs sampling in case of normal prior distribution for µ')
c_prior_mean <- 0.5
c_prior_variance <- 0.25^2
c_result <- gibbsSampling_normalPrior(sampleData, c_prior_mean, c_prior_variance)
# Trace plot of µ
serialNumber <- seq(from=1, to=numberOfSimulations, by=1)
df <- data.frame(draw = serialNumber, mu = c_result$mu)
ggplot(df, aes(x = draw, y = mu)) +
geom_line(color = "blue") +
labs(title = 'Trace plot of µ (in case of normal prior distribution for µ where m_prior = 0.5, v_prior = 0.0625)',
x = 'Draw', y = 'µ') +
theme_minimal()
ggsave('figures/c_normalPrior_tracePlot.png', width = 10, height = 6, dpi = 300)
# estimate the posterior probabilities
print('The posterior probabilities are:')
sum_mu_greater_0 <- sum(c_result$mu[numberOfBurnIn:numberOfSimulations] > 0)
print(paste('Pr(µ > 0 | y) =', sum_mu_greater_0/(numberOfSimulations-numberOfBurnIn)))
sum_mu_less_0 <- sum(c_result$mu[numberOfBurnIn:numberOfSimulations] < 0)
print(paste('Pr(µ < 0 | y) =', sum_mu_less_0/(numberOfSimulations-numberOfBurnIn)))
twoSidedTest <- function(input_t) {
if (input_t > -2.2622 & input_t < 2.2622) {
print('t ∈ [-2.2622, 2.2622]: Do not reject the null.')
} else {
print('t ∉ [-2.2622, 2.2622]: Reject the null.')
}
}
a_t_statistic <-mean(a_result$mu) / sqrt(var(a_result$mu)/length(a_result$mu))
print('A classical/frequentist two-sided test in (a):')
twoSidedTest(a_t_statistic)
b_t_statistic <- mean(b_result$mu) / sqrt(var(b_result$mu)/length(b_result$mu))
print('A classical/frequentist two-sided test in (b):')
twoSidedTest(b_t_statistic)
c_t_statistic <- mean(c_result$mu) / sqrt(var(c_result$mu)/length(c_result$mu))
print('A classical/frequentist two-sided test in (c):')
twoSidedTest(c_t_statistic)
twoSidedTest <- function(input_t) {
if (input_t > -2.2622 & input_t < 2.2622) {
print('t ∈ [-2.2622, 2.2622]: Do not reject the null.')
} else {
print('t ∉ [-2.2622, 2.2622]: Reject the null.')
}
}
a_t_statistic <-mean(a_result$mu) / sqrt(var(a_result$mu)/length(a_result$mu))
print('A classical/frequentist two-sided test in (a):')
print(paste('Test statistic:', a_t_statistic))
twoSidedTest(a_t_statistic)
b_t_statistic <- mean(b_result$mu) / sqrt(var(b_result$mu)/length(b_result$mu))
print('A classical/frequentist two-sided test in (b):')
print(paste('Test statistic:', b_t_statistic))
twoSidedTest(b_t_statistic)
c_t_statistic <- mean(c_result$mu) / sqrt(var(c_result$mu)/length(c_result$mu))
print('A classical/frequentist two-sided test in (c):')
print(paste('Test statistic:', c_t_statistic))
twoSidedTest(c_t_statistic)
# calculate standrized residuals
residual <- (compoundedReturns[(window+1):length(compoundedReturns)])
residual_MA <- residual / MA_volatility[1:(length(hat_y)-1)]
residual_EWMA <- residual / EWMA_volatility[window:(length(compoundedReturns)-1)]
# residual autocorrelation checking
MA_result <- plotACF(residual_MA,
input_maxLags = window,
objectName = 'Log Returns',
savePath = 'figures/residuals_MA_acf_plot.png')
EWMA_result <- plotACF(residual_EWMA,
input_maxLags = window,
objectName = 'Squared Log Returns',
savePath = 'figures/residuals_EWMA_acf_plot.png')
# Distribution of Standardized Residuals
residual_df <- data.frame(MA_vol =  residual_MA,
EWMA_vol = residual_EWMA)
ggplot(residual_df, aes(x = MA_vol)) +
geom_histogram(aes(y = ..density..),
bins = 50, fill = 'skyblue', color = 'blue') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_MA, na.rm = TRUE),
sd = sd(residual_MA, na.rm = TRUE)),
color = 'black', linewidth = 1, linetype = 'dashed') +
labs(title = 'Under MA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/MA_residual_distribution.png', width = 6, height = 6, dpi = 300)
ggplot(residual_df, aes(x = EWMA_vol)) +
geom_histogram(aes(y = ..density..),
bins = 50, fill = 'orange', color = 'darkorange') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_EWMA, na.rm = TRUE),
sd = sd(residual_EWMA, na.rm = TRUE)),
color = 'black', linewidth = 1, linetype = 'dashed') +
labs(title = 'Under EWMA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/EWMA_residual_distribution.png', width = 6, height = 6, dpi = 300)
# Ljung-Box Test
MA_LBTest <- LBTest((residual_MA^2), 50, 10)
MA_LBTest
EWMA_LBTest <- LBTest((residual_EWMA^2), 50, 10)
EWMA_LBTest
library('tseries')
# Jarque-Bera Test
MA_JBTest <- jarque.bera.test(residual_MA)
EWMA_JBTest <- jarque.bera.test(residual_EWMA)
JBTest_result_df <- data.frame(Model = string(),
Statistic = numeric(),
Crit_Value = numeric(),
P_Value = numeric())
View(MA_JBTest)
# calculate standrized residuals
residual <- (compoundedReturns[(window+1):length(compoundedReturns)])
residual_MA <- residual / MA_volatility[1:(length(hat_y)-1)]
residual_EWMA <- residual / EWMA_volatility[window:(length(compoundedReturns)-1)]
# residual autocorrelation checking
MA_result <- plotACF(residual_MA,
input_maxLags = window,
objectName = 'Log Returns',
savePath = 'figures/residuals_MA_acf_plot.png')
EWMA_result <- plotACF(residual_EWMA,
input_maxLags = window,
objectName = 'Squared Log Returns',
savePath = 'figures/residuals_EWMA_acf_plot.png')
# Distribution of Standardized Residuals
residual_df <- data.frame(MA_vol =  residual_MA,
EWMA_vol = residual_EWMA)
ggplot(residual_df, aes(x = MA_vol)) +
geom_histogram(aes(y = ..density..),
bins = 50, fill = 'skyblue', color = 'blue') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_MA, na.rm = TRUE),
sd = sd(residual_MA, na.rm = TRUE)),
color = 'black', linewidth = 1, linetype = 'dashed') +
labs(title = 'Under MA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/MA_residual_distribution.png', width = 6, height = 6, dpi = 300)
ggplot(residual_df, aes(x = EWMA_vol)) +
geom_histogram(aes(y = ..density..),
bins = 50, fill = 'orange', color = 'darkorange') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_EWMA, na.rm = TRUE),
sd = sd(residual_EWMA, na.rm = TRUE)),
color = 'black', linewidth = 1, linetype = 'dashed') +
labs(title = 'Under EWMA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/EWMA_residual_distribution.png', width = 6, height = 6, dpi = 300)
# Ljung-Box Test
MA_LBTest <- LBTest((residual_MA^2), 50, 10)
MA_LBTest
EWMA_LBTest <- LBTest((residual_EWMA^2), 50, 10)
EWMA_LBTest
library('tseries')
# Jarque-Bera Test
MA_JBTest <- jarque.bera.test(residual_MA)
EWMA_JBTest <- jarque.bera.test(residual_EWMA)
JBTest_result_df <- data.frame(Model = character(),
Statistic = numeric(),
Crit_Value = numeric(),
P_Value = numeric())
MA_newRow <- data.frame(Model = 'MA',
Statistic = round(MA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = MA_JBTest$parameter), 4),
P_Value = signif(MA_JBTest$p.value, 4))
EWMA_newRow <- data.frame(Model = 'EWMA',
Statistic = round(EWMA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = EWMA_JBTest$parameter), 4),
P_Value = signif(EWMA_JBTest$p.value, 4))
result_df <- rbind(JBTest_result_df,MA_newRow)
result_df <- rbind(JBTest_result_df,EWMA_newRow)
# calculate standrized residuals
residual <- (compoundedReturns[(window+1):length(compoundedReturns)])
residual_MA <- residual / MA_volatility[1:(length(hat_y)-1)]
residual_EWMA <- residual / EWMA_volatility[window:(length(compoundedReturns)-1)]
# residual autocorrelation checking
MA_result <- plotACF(residual_MA,
input_maxLags = window,
objectName = 'Log Returns',
savePath = 'figures/residuals_MA_acf_plot.png')
EWMA_result <- plotACF(residual_EWMA,
input_maxLags = window,
objectName = 'Squared Log Returns',
savePath = 'figures/residuals_EWMA_acf_plot.png')
# Distribution of Standardized Residuals
residual_df <- data.frame(MA_vol =  residual_MA,
EWMA_vol = residual_EWMA)
ggplot(residual_df, aes(x = MA_vol)) +
geom_histogram(aes(y = ..density..),
bins = 50, fill = 'skyblue', color = 'blue') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_MA, na.rm = TRUE),
sd = sd(residual_MA, na.rm = TRUE)),
color = 'black', linewidth = 1, linetype = 'dashed') +
labs(title = 'Under MA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/MA_residual_distribution.png', width = 6, height = 6, dpi = 300)
ggplot(residual_df, aes(x = EWMA_vol)) +
geom_histogram(aes(y = ..density..),
bins = 50, fill = 'orange', color = 'darkorange') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_EWMA, na.rm = TRUE),
sd = sd(residual_EWMA, na.rm = TRUE)),
color = 'black', linewidth = 1, linetype = 'dashed') +
labs(title = 'Under EWMA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/EWMA_residual_distribution.png', width = 6, height = 6, dpi = 300)
# Ljung-Box Test
MA_LBTest <- LBTest((residual_MA^2), 50, 10)
MA_LBTest
EWMA_LBTest <- LBTest((residual_EWMA^2), 50, 10)
EWMA_LBTest
library('tseries')
# Jarque-Bera Test
MA_JBTest <- jarque.bera.test(residual_MA)
EWMA_JBTest <- jarque.bera.test(residual_EWMA)
JBTest_result_df <- data.frame(Model = character(),
Statistic = numeric(),
Crit_Value = numeric(),
P_Value = numeric())
MA_newRow <- data.frame(Model = 'MA',
Statistic = round(MA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = MA_JBTest$parameter), 4),
P_Value = signif(MA_JBTest$p.value, 4))
EWMA_newRow <- data.frame(Model = 'EWMA',
Statistic = round(EWMA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = EWMA_JBTest$parameter), 4),
P_Value = signif(EWMA_JBTest$p.value, 4))
JBTest_result_df <- rbind(JBTest_result_df,MA_newRow)
JBTest_result_df <- rbind(JBTest_result_df,EWMA_newRow)
JBTest_result_df
# calculate standrized residuals
residual <- (compoundedReturns[(window+1):length(compoundedReturns)])
residual_MA <- residual / MA_volatility[1:(length(hat_y)-1)]
residual_EWMA <- residual / EWMA_volatility[window:(length(compoundedReturns)-1)]
# residual autocorrelation checking
MA_result <- plotACF(residual_MA,
input_maxLags = window,
objectName = 'Log Returns',
savePath = 'figures/residuals_MA_acf_plot.png')
EWMA_result <- plotACF(residual_EWMA,
input_maxLags = window,
objectName = 'Squared Log Returns',
savePath = 'figures/residuals_EWMA_acf_plot.png')
# Distribution of Standardized Residuals
residual_df <- data.frame(MA_vol =  residual_MA,
EWMA_vol = residual_EWMA)
ggplot(residual_df, aes(x = MA_vol)) +
geom_histogram(aes(y = ..density..),
bins = 50, fill = 'skyblue', color = 'blue') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_MA, na.rm = TRUE),
sd = sd(residual_MA, na.rm = TRUE)),
color = 'black', linewidth = 1, linetype = 'dashed') +
labs(title = 'Under MA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/MA_residual_distribution.png', width = 6, height = 6, dpi = 300)
ggplot(residual_df, aes(x = EWMA_vol)) +
geom_histogram(aes(y = ..density.., fill = 'Empirical Distribution'),
bins = 50, color = 'darkorange') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_EWMA, na.rm = TRUE),
sd = sd(residual_EWMA, na.rm = TRUE)),
aes(color = 'Normal Distribution'), linewidth = 1, linetype = 'dashed') +
scale_color_manual(name = "Distributions",
values = c('Normal Distribution' = 'black',
'Empirical Distribution' = 'orange')) +
labs(title = 'Under EWMA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/EWMA_residual_distribution.png', width = 6, height = 6, dpi = 300)
# Ljung-Box Test
MA_LBTest <- LBTest((residual_MA^2), 50, 10)
MA_LBTest
EWMA_LBTest <- LBTest((residual_EWMA^2), 50, 10)
EWMA_LBTest
library('tseries')
# Jarque-Bera Test
MA_JBTest <- jarque.bera.test(residual_MA)
EWMA_JBTest <- jarque.bera.test(residual_EWMA)
JBTest_result_df <- data.frame(Model = character(),
Statistic = numeric(),
Crit_Value = numeric(),
P_Value = numeric())
MA_newRow <- data.frame(Model = 'MA',
Statistic = round(MA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = MA_JBTest$parameter), 4),
P_Value = signif(MA_JBTest$p.value, 4))
EWMA_newRow <- data.frame(Model = 'EWMA',
Statistic = round(EWMA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = EWMA_JBTest$parameter), 4),
P_Value = signif(EWMA_JBTest$p.value, 4))
JBTest_result_df <- rbind(JBTest_result_df,MA_newRow)
JBTest_result_df <- rbind(JBTest_result_df,EWMA_newRow)
JBTest_result_df
# calculate standrized residuals
residual <- (compoundedReturns[(window+1):length(compoundedReturns)])
residual_MA <- residual / MA_volatility[1:(length(hat_y)-1)]
residual_EWMA <- residual / EWMA_volatility[window:(length(compoundedReturns)-1)]
# residual autocorrelation checking
MA_result <- plotACF(residual_MA,
input_maxLags = window,
objectName = 'Log Returns',
savePath = 'figures/residuals_MA_acf_plot.png')
EWMA_result <- plotACF(residual_EWMA,
input_maxLags = window,
objectName = 'Squared Log Returns',
savePath = 'figures/residuals_EWMA_acf_plot.png')
# Distribution of Standardized Residuals
residual_df <- data.frame(MA_vol =  residual_MA,
EWMA_vol = residual_EWMA)
ggplot(residual_df, aes(x = MA_vol)) +
geom_histogram(aes(y = ..density..),
bins = 50, fill = 'skyblue', color = 'blue') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_MA, na.rm = TRUE),
sd = sd(residual_MA, na.rm = TRUE)),
color = 'black', linewidth = 1, linetype = 'dashed') +
labs(title = 'Under MA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/MA_residual_distribution.png', width = 6, height = 6, dpi = 300)
ggplot(residual_df, aes(x = EWMA_vol)) +
geom_histogram(aes(y = ..density.., color = 'Empirical Distribution'),
bins = 50, fill = 'orange') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_EWMA, na.rm = TRUE),
sd = sd(residual_EWMA, na.rm = TRUE)),
aes(color = 'Normal Distribution'), linewidth = 1, linetype = 'dashed') +
scale_color_manual(name = "Distributions",
values = c('Normal Distribution' = 'black',
'Empirical Distribution' = 'darkorange')) +
labs(title = 'Under EWMA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/EWMA_residual_distribution.png', width = 6, height = 6, dpi = 300)
# Ljung-Box Test
MA_LBTest <- LBTest((residual_MA^2), 50, 10)
MA_LBTest
EWMA_LBTest <- LBTest((residual_EWMA^2), 50, 10)
EWMA_LBTest
library('tseries')
# Jarque-Bera Test
MA_JBTest <- jarque.bera.test(residual_MA)
EWMA_JBTest <- jarque.bera.test(residual_EWMA)
JBTest_result_df <- data.frame(Model = character(),
Statistic = numeric(),
Crit_Value = numeric(),
P_Value = numeric())
MA_newRow <- data.frame(Model = 'MA',
Statistic = round(MA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = MA_JBTest$parameter), 4),
P_Value = signif(MA_JBTest$p.value, 4))
EWMA_newRow <- data.frame(Model = 'EWMA',
Statistic = round(EWMA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = EWMA_JBTest$parameter), 4),
P_Value = signif(EWMA_JBTest$p.value, 4))
JBTest_result_df <- rbind(JBTest_result_df,MA_newRow)
JBTest_result_df <- rbind(JBTest_result_df,EWMA_newRow)
JBTest_result_df
# calculate standrized residuals
residual <- (compoundedReturns[(window+1):length(compoundedReturns)])
residual_MA <- residual / MA_volatility[1:(length(hat_y)-1)]
residual_EWMA <- residual / EWMA_volatility[window:(length(compoundedReturns)-1)]
# residual autocorrelation checking
MA_result <- plotACF(residual_MA,
input_maxLags = window,
objectName = 'Log Returns',
savePath = 'figures/residuals_MA_acf_plot.png')
EWMA_result <- plotACF(residual_EWMA,
input_maxLags = window,
objectName = 'Squared Log Returns',
savePath = 'figures/residuals_EWMA_acf_plot.png')
# Distribution of Standardized Residuals
residual_df <- data.frame(MA_vol =  residual_MA,
EWMA_vol = residual_EWMA)
ggplot(residual_df, aes(x = MA_vol)) +
geom_histogram(aes(y = ..density..),
bins = 50, fill = 'skyblue', color = 'blue') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_MA, na.rm = TRUE),
sd = sd(residual_MA, na.rm = TRUE)),
color = 'black', linewidth = 1, linetype = 'dashed') +
labs(title = 'Under MA Volatility Models',
x = 'Standardized Residuals', y = 'Density')
ggsave('figures/MA_residual_distribution.png', width = 6, height = 6, dpi = 300)
ggplot(residual_df, aes(x = EWMA_vol)) +
geom_histogram(aes(y = ..density.., color = 'Empirical Distribution'),
bins = 50, fill = 'orange') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_EWMA, na.rm = TRUE),
sd = sd(residual_EWMA, na.rm = TRUE)),
aes(color = 'Normal Distribution'), linewidth = 1, linetype = 'dashed') +
scale_color_manual(name = "Distributions",
values = c('Normal Distribution' = 'black',
'Empirical Distribution' = 'darkorange')) +
labs(title = 'Under EWMA Volatility Models',
x = 'Standardized Residuals', y = 'Density') +
theme(legend.position = c(0.95, 0.95),
legend.justification = c("right", "top"),
legend.title = element_text(size = 12, face = "bold"),
legend.text = element_text(size = 10))
ggsave('figures/EWMA_residual_distribution.png', width = 6, height = 6, dpi = 300)
# Ljung-Box Test
MA_LBTest <- LBTest((residual_MA^2), 50, 10)
MA_LBTest
EWMA_LBTest <- LBTest((residual_EWMA^2), 50, 10)
EWMA_LBTest
library('tseries')
# Jarque-Bera Test
MA_JBTest <- jarque.bera.test(residual_MA)
EWMA_JBTest <- jarque.bera.test(residual_EWMA)
JBTest_result_df <- data.frame(Model = character(),
Statistic = numeric(),
Crit_Value = numeric(),
P_Value = numeric())
MA_newRow <- data.frame(Model = 'MA',
Statistic = round(MA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = MA_JBTest$parameter), 4),
P_Value = signif(MA_JBTest$p.value, 4))
EWMA_newRow <- data.frame(Model = 'EWMA',
Statistic = round(EWMA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = EWMA_JBTest$parameter), 4),
P_Value = signif(EWMA_JBTest$p.value, 4))
JBTest_result_df <- rbind(JBTest_result_df,MA_newRow)
JBTest_result_df <- rbind(JBTest_result_df,EWMA_newRow)
JBTest_result_df
# calculate standrized residuals
residual <- (compoundedReturns[(window+1):length(compoundedReturns)])
residual_MA <- residual / MA_volatility[1:(length(hat_y)-1)]
residual_EWMA <- residual / EWMA_volatility[window:(length(compoundedReturns)-1)]
# residual autocorrelation checking
MA_result <- plotACF(residual_MA,
input_maxLags = window,
objectName = 'Log Returns',
savePath = 'figures/residuals_MA_acf_plot.png')
EWMA_result <- plotACF(residual_EWMA,
input_maxLags = window,
objectName = 'Squared Log Returns',
savePath = 'figures/residuals_EWMA_acf_plot.png')
# Distribution of Standardized Residuals
residual_df <- data.frame(MA_vol =  residual_MA,
EWMA_vol = residual_EWMA)
ggplot(residual_df, aes(x = MA_vol)) +
geom_histogram(aes(y = ..density.., color = 'Empirical Distribution'),
bins = 50, fill = 'skyblue') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_MA, na.rm = TRUE),
sd = sd(residual_MA, na.rm = TRUE)),
aes(color = 'Normal Distribution'), linewidth = 1, linetype = 'dashed') +
scale_color_manual(name = "Distributions",
values = c('Normal Distribution' = 'black',
'Empirical Distribution' = 'blue')) +
labs(title = 'Under MA Volatility Models',
x = 'Standardized Residuals', y = 'Density') +
theme(legend.position = c(0.95, 0.95),
legend.justification = c("right", "top"),
legend.title = element_text(size = 12, face = "bold"),
legend.text = element_text(size = 10))
ggsave('figures/MA_residual_distribution.png', width = 6, height = 6, dpi = 300)
ggplot(residual_df, aes(x = EWMA_vol)) +
geom_histogram(aes(y = ..density.., color = 'Empirical Distribution'),
bins = 50, fill = 'orange') +
stat_function(fun = dnorm,
args = list(mean = mean(residual_EWMA, na.rm = TRUE),
sd = sd(residual_EWMA, na.rm = TRUE)),
aes(color = 'Normal Distribution'), linewidth = 1, linetype = 'dashed') +
scale_color_manual(name = "Distributions",
values = c('Normal Distribution' = 'black',
'Empirical Distribution' = 'darkorange')) +
labs(title = 'Under EWMA Volatility Models',
x = 'Standardized Residuals', y = 'Density') +
theme(legend.position = c(0.95, 0.95),
legend.justification = c("right", "top"),
legend.title = element_text(size = 12, face = "bold"),
legend.text = element_text(size = 10))
ggsave('figures/EWMA_residual_distribution.png', width = 6, height = 6, dpi = 300)
# Ljung-Box Test
MA_LBTest <- LBTest((residual_MA^2), 50, 10)
MA_LBTest
EWMA_LBTest <- LBTest((residual_EWMA^2), 50, 10)
EWMA_LBTest
library('tseries')
# Jarque-Bera Test
MA_JBTest <- jarque.bera.test(residual_MA)
EWMA_JBTest <- jarque.bera.test(residual_EWMA)
JBTest_result_df <- data.frame(Model = character(),
Statistic = numeric(),
Crit_Value = numeric(),
P_Value = numeric())
MA_newRow <- data.frame(Model = 'MA',
Statistic = round(MA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = MA_JBTest$parameter), 4),
P_Value = signif(MA_JBTest$p.value, 4))
EWMA_newRow <- data.frame(Model = 'EWMA',
Statistic = round(EWMA_JBTest$statistic, 4),
Critical_Value = round(qchisq(0.95, df = EWMA_JBTest$parameter), 4),
P_Value = signif(EWMA_JBTest$p.value, 4))
JBTest_result_df <- rbind(JBTest_result_df,MA_newRow)
JBTest_result_df <- rbind(JBTest_result_df,EWMA_newRow)
JBTest_result_df
?Box.test
twoSidedTest <- function(input_t) {
if (input_t > -2.2622 & input_t < 2.2622) {
print('t ∈ [-2.2622, 2.2622]: Do not reject the null.')
} else {
print('t ∉ [-2.2622, 2.2622]: Reject the null.')
}
}
t_statistic <- mean(sampleData) / sqrt(var(sampleData)/length(sampleData))
print('A classical/frequentist two-sided test:')
print(paste('Test statistic:', t_statistic))
twoSidedTest(t_statistic)
